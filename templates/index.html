<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BetterDay Bookings</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        :root { --primary: #ff4d4d; --bg: #f8f9fa; }
        body { background: var(--bg); font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        
        .calendar-card {
            background: white; border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05); padding: 25px;
            margin-top: 30px; max-width: 900px; margin-inline: auto;
        }

        .calendar-grid {
            display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px;
        }

        .weekday-header {
            text-align: center; font-weight: 700; font-size: 0.8rem;
            text-transform: uppercase; color: #adb5bd; padding-bottom: 10px;
        }

        .day-box {
            aspect-ratio: 1/1; border-radius: 12px; border: 2px solid #f1f3f5;
            display: flex; flex-direction: column; align-items: center; 
            justify-content: center; text-decoration: none; transition: 0.2s;
            position: relative;
        }

        /* Available Mon-Wed */
        .day-box.available { background: white; border-color: #e9ecef; color: #495057; }
        .day-box.available:hover { border-color: var(--primary); transform: translateY(-3px); box-shadow: 0 5px 15px rgba(255,77,77,0.15); }

        /* Taken/Sold Out */
        .day-box.taken { background: #fff5f5; border-color: #ffc9c9; color: #fa5252; pointer-events: none; }
        .day-box.taken::after { content: "Sold"; font-size: 0.6rem; font-weight: bold; position: absolute; bottom: 5px; }

        /* Unavailable Thu-Sun */
        .day-box.unavailable { background: #f1f3f5; border-color: #f1f3f5; color: #dee2e6; pointer-events: none; }

        .day-num { font-size: 1.2rem; font-weight: 600; }
        
        .header-section { text-align: center; margin-bottom: 30px; }
        .apple-logo { font-size: 3rem; }
    </style>
</head>
<body>

<div class="container">
    <div class="calendar-card">
        <div class="header-section">
            <div class="apple-logo">üçé</div>
            <h1 class="fw-bold">School Lunch Drop-off</h1>
            <p class="text-muted">Monday, Tuesday, and Wednesdays available</p>
            <h3 class="mt-4">{{ dates[0].raw_date | to_datetime | format_datetime_month }}</h3>
        </div>

        <div class="calendar-grid">
            <div class="weekday-header">Mon</div>
            <div class="weekday-header">Tue</div>
            <div class="weekday-header">Wed</div>
            <div class="weekday-header)Header">Thu</div>
            <div class="weekday-header">Fri</div>
            <div class="weekday-header">Sat</div>
            <div class="weekday-header">Sun</div>

            {% for date in dates %}
                {% set d = date.raw_date | to_datetime %}
                {# weekday() 0=Mon, 1=Tue, 2=Wed, 3=Thu... #}
                {% set is_valid_day = d.weekday() < 3 %}
                
                <a href="/book/{{ date.raw_date }}" 
                   class="day-box 
                   {{ 'taken' if date.taken else '' }} 
                   {{ 'available' if not date.taken and is_valid_day else '' }} 
                   {{ 'unavailable' if not is_valid_day else '' }}">
                    <span class="day-num">{{ d.day }}</span>
                </a>
            {% endfor %}
        </div>
    </div>
</div>

</body>
</html>
